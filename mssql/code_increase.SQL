ROW_NUMBER() OVER(ORDER BY 컬럼)

SELECT 'TH'+REPLICATE('0', 3-LEN(VAL))+VAL AS GUBUN_CODE
  FROM (
        SELECT CONVERT(CHAR(3), ISNULL(CONVERT(INT, REPLACE(MAX(GUBUN_CODE), 'TH', '')), 0)+1) AS VAL
          FROM DLIT_TEMP_MANAGE
         WHERE GUBUN_CODE LIKE 'TH%'
       ) AS A
;

select *
FROM DLIT_TEMP_MANAGE
WHERE GUBUN_CODE LIKE 'TH%'
;




CONVERT(CHAR(3), ISNULL(CONVERT(INT, REPLACE(MAX(GUBUN_CODE), 'TH', '')), 0)+1) AS VAL


ISNULL(CONVERT(INT, REPLACE(MAX(GUBUN_CODE), 'TH', '')), 0)

CONVERT(INT, REPLACE(MAX(GUBUN_CODE), 'TH', ''))

REPLACE(MAX(GUBUN_CODE), 'TH', '')

MAX(GUBUN_CODE)